webrtc: yes
webrtcAllowOrigins: ["*"]
webrtcAddress: :8889
webrtcLocalUDPAddress: :8189

# 告訴 MediaMTX 它的對外公網域名，這非常重要！
webrtcAdditionalHosts: [${FLY_APP_NAME}.fly.dev]

# 權限控制 (身份驗證)
authMethod: http
# 注意: $BACKEND_API_URL 將在啟動時由 Docker 替換為實際的後端網址
authHTTPAddress: $BACKEND_API_URL/api/stream/auth

paths:
  all_others:
    # 當推流準備就緒時 (通知後端直播開始)
    runOnReady: 'curl -m 5 -s -X POST $BACKEND_API_URL/api/stream/publish -H "Content-Type: application/json" -d "{\"slug\":\"$MTX_PATH\"}"'

    # 當推流停止時 (通知後端直播結束)
    runOnNotReady: 'curl -m 5 -s -X POST $BACKEND_API_URL/api/stream/unpublish -H "Content-Type: application/json" -d "{\"slug\":\"$MTX_PATH\"}"'
